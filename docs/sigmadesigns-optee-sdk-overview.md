# SigmaDesigns OP-TEE SDK  - Overview

---
## Contents

1.  [Directory structure](#1-Directory-structure)
2.  [Introduction](#2-Introduction)
3.  [TEE API extensions](#3-TEE-internal-API-extensions)
4.  [Build Type](#4-Build-Type)

---
# 1. Directory structure

    optee_sdk_soc-name
      |----docs                          # documentation folder
      |----host                          # folder for host stuffs
      |      |----arm-linux-gnueabihf    # flavor generated by arm-linux-gnueabihf-gcc
      |      |      |----bin             # prebuilt binaries,i.e. xtest
      |      |      |----teec            # tee client folder
      |      |            |----bin       # tee client binaries, current tee-supplicant only
      |      |            |----include   # tee client header files
      |      |            |----lib       # tee client libraries
      |      |----aarch64-linux-gnu      # flavor generated by aarch64-linux-gnu-gcc
      |      |----????
      |----mk                            # make helpers folder
      |      |----common.mk              # makefile helper
      |----ta                            # folder for prebuilt TAs
      |----tee                           # tee folder
      |      |----debug                  # debug build
      |      |----release                # release build
      |             |----core
      |                   |----tee.bin   # secure os binary
      |             |----export-ta_arm32 # ta-dev-kit for aarch32 mode
      |             |----export-ta_arm64 # ta-dev-kit for aarch64 mode
      |----tee_release.h                 # tee sdk header file with essential release infos

---
# 2. Introduction

The OP-TEE SDK is generated based on OP-TEE v2.3.0 release by using toolchains:

    AARCH32 toolchain: gcc-linaro-5.3-2016.02-x86_64_arm-linux-gnueabihf
    AARCH64 toolchain: gcc-linaro-5.3-2016.02-x86_64_aarch64-linux-gnu

Please refer to [Guidance on sdesigns ARM GNU/Linux toolchain](http://avenue.sdesigns.com/depts/RD/Teams/DTV/Wiki/Guidance%20on%20sdesigns%20ARM%20GNU%20Linux%20toolchain.aspx) for more details on ARM toolchains.

Secure OS is built in aarch64 mode, and TAs are built in aarch32 mode.
Host components are provided in diverse flavors, with each prebuilt by certain cross compiler of either aarch64
or aarch32 mode, which gives client applications the flexibility to choose different cross compilers and
execution state as well, aarch64 or aarch32. 

---
# 3. TEE API extensions

## Introduction

We have to extend GP Core API by adding several TEE APIs mainly for:
* enable TAs play with necessary platform specific drivers (OTP,PMAN).
* fit for particular use cases (user remap).
* play with turing driver (key ladder).

In order to avoid collisions with TEE APIs, all extended TEE APIs are collected in `libuteex`.

Please refer to `tee_api_ext.h` for details.

## Extended API List
|TEE_API_EXT| Notes |
|-------|----------------------|
|`TEE_Ext_Init`|Optional|
|`TEE_Ext_DeInit`|Optional|
|`TEE_Mmap`||
|`TEE_Munmap`||
|`TEE_OtpWrite`|ULI TA accessible only|
|`TEE_MemState`||
|`TEE_KLGenerateKey`|Supports user (operation) and TSP keys. It acts equivalently as `TEE_GenerateKey` when used to generate user key. The generated keys are with natures: *`uniqueness` on TA basis;* *`consistency` within certain TA.*|

## Test Case
A group of test cases are provided based on xtest framework, with essential coverage over extended APIs.
Here is the list of test cases:
| ID | Description |
|-------|----------------------|
|`90001`|Test TEE extension APIs Mmap/Munmap - generic|
|`90002`|Test TEE extension APIs Mmap/Munmap - stress|
|`90003`|Test TEE extension APIs Mmap/Munmap - accessible|
|`90004`|Test TEE extension API OtpWrite|
|`90005`|Test TEE extension API MemState|
|`90006`|Test TEE extension API KLGenerateKey - cipher operations with use key|
|`90007`|Test TEE extension API KLGenerateKey - consistency|
|`90008`|Test TEE extension API KLGenerateKey - uniqueness|
|`90009`|Test TEE extension API KLGenerateKey - TSP key|

---
# 4. Build Type
Two different build type are supported: `debug` and `release`.

- `debug` outcomings are with essential debug capabilities that can be helpful during developing phase, i.e. assert is enabled, .etc. They are collected under path tee/debug.

- By contrast, `release` outcomings drop all debug features so as to be better suitable for project use. They are collected under path tee/release

---
